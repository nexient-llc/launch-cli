import os
import pytest

from unittest.mock import patch, mock_open
from launch.pipeline.common.functions import *


@pytest.fixture(scope="function")

def test_set_netrc_success():
    with patch('open', mock_open()) as mock_file, \
         patch('os.chmod') as mock_chmod:
        set_netrc('password123')
        mock_file.assert_called_once_with(os.path.expanduser('~/.netrc'), 'a')
        mock_chmod.assert_called_once_with(os.path.expanduser('~/.netrc'), 0o600)

def test_set_netrc_exception():
    with patch('open', side_effect=Exception('Test Error')), \
         patch('os.chmod'):
        with pytest.raises(RuntimeError):
            set_netrc('password123')